import { prisma } from '@/lib/prisma'; import { NextRequest, NextResponse } from 'next/server'; export async function GET(){ const data=await prisma.incident.findMany({orderBy:{createdAt:'desc'}}); return NextResponse.json(data);} export async function POST(req:NextRequest){ const body=await req.json(); try{ const item=await prisma.incident.create({data:{ title:String(body.title), description:String(body.description), date:new Date(body.date), reporterName:String(body.reporterName), correspondent:String(body.correspondent), area:String(body.area), status:(body.status||'OPEN') as any, controlOwner:String(body.controlOwner), nextSteps: body.nextSteps? String(body.nextSteps): null }}); return NextResponse.json({ok:true,id:item.id}); }catch(e:any){ return new NextResponse(e.message||'Error',{status:400}); }}