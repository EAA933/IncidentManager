import { prisma } from '@/lib/prisma'; import { NextRequest, NextResponse } from 'next/server'; export async function POST(req:NextRequest,{params}:{params:{id:string}}){ const body=await req.json(); try{ const upd=await prisma.update.create({data:{ incidentId:params.id, note:String(body.note), status: body.status? String(body.status) as any : null, author: String(body.author||'usuario') }}); if(body.status){ await prisma.incident.update({where:{id:params.id}, data:{ status: String(body.status) as any }}); } return NextResponse.json(upd);}catch(e:any){ return new NextResponse(e.message||'Error',{status:400}); }}